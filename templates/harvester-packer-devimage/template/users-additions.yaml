users:
{%- for user in values.existingUsers %}
  - name: ${{ user.name }}
    groups: ${{ user.groups | default('sudo') }}
    shell: ${{ user.shell | default('/bin/bash') }}
    sudo: ${{ user.sudo | default('ALL=(ALL) NOPASSWD:ALL') }} # pragma: allowlist secret
    ssh_authorized_keys:
{%- for key in user.ssh_authorized_keys %}
      - ${{ key }} # pragma: allowlist secret
{%- endfor %}
{%- endfor %}
{%- for user in values.newUsers %}
  - name: ${{ user.name }}
    groups: ${{ user.groups | default('sudo') }}
    shell: ${{ user.shell | default('/bin/bash') }}
    sudo: ${{ user.sudo | default('ALL=(ALL) NOPASSWD:ALL') }} # pragma: allowlist secret
    ssh_authorized_keys:
{%- for key in user.ssh_authorized_keys %}
      - ${{ key }} # pragma: allowlist secret
{%- endfor %}
{%- endfor %}
